data:text/html;base64,PCFkb2N0eXBlIGh0bWw+CjxodG1sIGxhbmc9InpoLUNOIj4KPG1ldGEgY2hhcnNldD0idXRmLTgiPgo8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLGluaXRpYWwtc2NhbGU9MSI+Cjx0aXRsZT7mnKzlnLAgU3RlYW0gVE9UUCDnlJ/miJDlmag8L3RpdGxlPgo8c3R5bGU+CiAgICBib2R5IHsKICAgICAgICBmb250LWZhbWlseTogc3lzdGVtLXVpLCAtYXBwbGUtc3lzdGVtLCBTZWdvZSBVSSwgUm9ib3RvLCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmOwogICAgICAgIHBhZGRpbmc6IDIwcHg7CiAgICAgICAgbWF4LXdpZHRoOiA2ODBweDsKICAgICAgICBtYXJnaW46IGF1dG87CiAgICAgICAgbGluZS1oZWlnaHQ6IDEuNAogICAgfQoKICAgIGgxIHsKICAgICAgICBmb250LXNpemU6IDIwcHg7CiAgICAgICAgbWFyZ2luOiAwIDAgMTJweAogICAgfQoKICAgIGxhYmVsIHsKICAgICAgICBkaXNwbGF5OiBibG9jazsKICAgICAgICBtYXJnaW46IDEwcHggMCA2cHgKICAgIH0KCiAgICBpbnB1dFt0eXBlPXRleHRdIHsKICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICBwYWRkaW5nOiAxMHB4OwogICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7CiAgICAgICAgYm9yZGVyLXJhZGl1czogMTBweDsKICAgICAgICBmb250LXNpemU6IDE0cHgKICAgIH0KCiAgICBidXR0b24gewogICAgICAgIHBhZGRpbmc6IDEwcHggMTRweDsKICAgICAgICBib3JkZXI6IDA7CiAgICAgICAgYm9yZGVyLXJhZGl1czogMTBweDsKICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgYm94LXNoYWRvdzogMCAxcHggMnB4IHJnYmEoMCwgMCwgMCwgLjEpCiAgICB9CgogICAgI3N0YXJ0IHsKICAgICAgICBiYWNrZ3JvdW5kOiAjNENBRjUwOwogICAgICAgIGNvbG9yOiB3aGl0ZTsKICAgIH0KCiAgICAjY29weSB7CiAgICAgICAgYmFja2dyb3VuZDogIzIxOTZGMzsKICAgICAgICBjb2xvcjogd2hpdGU7CiAgICB9CgogICAgI2NvcHk6ZGlzYWJsZWQgewogICAgICAgIGJhY2tncm91bmQ6ICNjY2M7CiAgICAgICAgY3Vyc29yOiBub3QtYWxsb3dlZDsKICAgIH0KCiAgICAuY29weS1zdWNjZXNzIHsKICAgICAgICBiYWNrZ3JvdW5kOiAjNENBRjUwICFpbXBvcnRhbnQ7CiAgICB9CgogICAgLmNvZGUgewogICAgICAgIGZvbnQtc2l6ZTogNDJweDsKICAgICAgICBsZXR0ZXItc3BhY2luZzogMnB4OwogICAgICAgIGZvbnQtd2VpZ2h0OiA3MDA7CiAgICAgICAgbWFyZ2luLXRvcDogMTJweAogICAgfQoKICAgIC5yb3cgewogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgZ2FwOiA4cHg7CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBtYXJnaW4tdG9wOiA4cHgKICAgIH0KCiAgICBzbWFsbCB7CiAgICAgICAgb3BhY2l0eTogLjcKICAgIH0KCiAgICAucHJvZ3Jlc3MgewogICAgICAgIGhlaWdodDogOHB4OwogICAgICAgIGJhY2tncm91bmQ6ICNlZWU7CiAgICAgICAgYm9yZGVyLXJhZGl1czogOTlweDsKICAgICAgICBvdmVyZmxvdzogaGlkZGVuCiAgICB9CgogICAgLnByb2dyZXNzPmkgewogICAgICAgIGRpc3BsYXk6IGJsb2NrOwogICAgICAgIGhlaWdodDogMTAwJTsKICAgICAgICB3aWR0aDogMCUKICAgIH0KCiAgICBmb290ZXIgewogICAgICAgIG1hcmdpbi10b3A6IDE2cHg7CiAgICAgICAgZm9udC1zaXplOiAxMnB4OwogICAgICAgIG9wYWNpdHk6IC43CiAgICB9Cjwvc3R5bGU+Cgo8aDE+5pys5ZywIFN0ZWFtIFRPVFAg55Sf5oiQ5ZmoPC9oMT4KPGxhYmVsPlNlY3JldO+8iEJhc2UzMi9CYXNlNjTvvIk8L2xhYmVsPgo8aW5wdXQgaWQ9InNlY3JldCIgdHlwZT0idGV4dCIgcGxhY2Vob2xkZXI9IuS+i+Wmgu+8mmNuT2d2L0tkcExvUDZOYmgwR01rWGtQWEFMUT0g5oiWIE1OT0hXN1dLWEZJN1JaV0dFUUdNVkZUUlU3R0FGSUE9Ij4KPGRpdiBjbGFzcz0icm93Ij4KICAgIDxidXR0b24gaWQ9ImNvcHkiIGRpc2FibGVkPuWkjeWItjwvYnV0dG9uPgo8L2Rpdj4KPGRpdiBjbGFzcz0iY29kZSIgaWQ9ImNvZGUiPuKAlOKAlOKAlDwvZGl2Pgo8ZGl2IGNsYXNzPSJwcm9ncmVzcyI+PGkgaWQ9ImJhciI+PC9pPjwvZGl2Pgo8ZGl2IGNsYXNzPSJyb3ciPjxzbWFsbCBpZD0ibGVmdCI+5Ymp5L2ZIOKAlCBzPC9zbWFsbD48L2Rpdj4KPGZvb3Rlcj7lrozlhajnprvnur/orqHnrpfjgILmlK/mjIEgQmFzZTMyKEFlZ2lz562J6aqM6K+B5Zmo5a+G6ZKlKSAvIEJhc2U2NChzaGFyZWRfc2VjcmV0KSDmoLzlvI/jgIIKPC9mb290ZXI+Cgo8c2NyaXB0PgogICAgY29uc3QgQ0hBUlMgPSAiMjM0NTY3ODlCQ0RGR0hKS01OUFFSVFZXWFkiOwogICAgY29uc3QgQkFTRTMyX0NIQVJTID0gIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaMjM0NTY3IjsKCiAgICBmdW5jdGlvbiBiYXNlMzJUb0Jhc2U2NChiYXNlMzIpIHsKICAgICAgICBjb25zdCBjbGVhbkIzMiA9IGJhc2UzMi5yZXBsYWNlKC9bPVxzXS9nLCAnJykudG9VcHBlckNhc2UoKTsKICAgICAgICBsZXQgYml0cyA9ICcnOwogICAgICAgIGZvciAoY29uc3QgY2hhciBvZiBjbGVhbkIzMikgewogICAgICAgICAgICBjb25zdCB2YWwgPSBCQVNFMzJfQ0hBUlMuaW5kZXhPZihjaGFyKTsKICAgICAgICAgICAgaWYgKHZhbCA9PT0gLTEpIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBCYXNlMzInKTsKICAgICAgICAgICAgYml0cyArPSB2YWwudG9TdHJpbmcoMikucGFkU3RhcnQoNSwgJzAnKTsKICAgICAgICB9CiAgICAgICAgY29uc3QgYnl0ZXMgPSBbXTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJpdHMubGVuZ3RoIC0gNzsgaSArPSA4KSB7CiAgICAgICAgICAgIGJ5dGVzLnB1c2gocGFyc2VJbnQoYml0cy5zdWJzdHIoaSwgOCksIDIpKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGJ0b2EoU3RyaW5nLmZyb21DaGFyQ29kZSguLi5ieXRlcykpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRldGVjdEFuZENvbnZlcnQoc2VjcmV0KSB7CiAgICAgICAgY29uc3QgY2xlYW4gPSBzZWNyZXQudHJpbSgpLnJlcGxhY2UoL1xzL2csICcnKTsKICAgICAgICAvLyDmo4DmtYvmmK/lkKbkuLpCYXNlMzLvvIjlj6rljIXlkKtCYXNlMzLlrZfnrKbkuJTplb/luqblkIjpgILvvIkKICAgICAgICBpZiAoL15bQS1aMi03PV0qJC9pLnRlc3QoY2xlYW4pICYmIGNsZWFuLmxlbmd0aCAlIDggPT09IDApIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJldHVybiBiYXNlMzJUb0Jhc2U2NChjbGVhbik7CiAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgLy8g5aaC5p6cQmFzZTMy6L2s5o2i5aSx6LSl77yM5bCd6K+V5L2c5Li6QmFzZTY05aSE55CGCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGNsZWFuOwogICAgfQoKICAgIC8vIOa3u+WKoOe8uuWkseeahCB0b0J5dGVzIOWHveaVsAogICAgZnVuY3Rpb24gdG9CeXRlcyhiNjQpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICAvLyDmuIXnkIYgQmFzZTY0IOWtl+espuS4sgogICAgICAgICAgICBjb25zdCBjbGVhbkI2NCA9IGI2NC5yZXBsYWNlKC9bXkEtWmEtejAtOSsvPV0vZywgJycpOwogICAgICAgICAgICByZXR1cm4gVWludDhBcnJheS5mcm9tKGF0b2IoY2xlYW5CNjQpLCBjID0+IGMuY2hhckNvZGVBdCgwKSk7CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIEJhc2U2NCBmb3JtYXQnKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gaTJieXRlczgoaSkgewogICAgICAgIGNvbnN0IGIgPSBuZXcgVWludDhBcnJheSg4KTsKICAgICAgICBmb3IgKGxldCBqID0gNzsgaiA+PSAwOyBqLS0pIHsgYltqXSA9IGkgJiAweGZmOyBpID4+PSA4OyB9CiAgICAgICAgcmV0dXJuIGI7CiAgICB9CgogICAgLy8g57qvIEphdmFTY3JpcHQg5a6e546w55qEIFNIQTEg566X5rOVCiAgICBmdW5jdGlvbiBzaGExKGRhdGEpIHsKICAgICAgICBmdW5jdGlvbiByb3RhdGVMZWZ0KG4sIHMpIHsKICAgICAgICAgICAgcmV0dXJuIChuIDw8IHMpIHwgKG4gPj4+ICgzMiAtIHMpKTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGFkZFVuc2lnbmVkKHgsIHkpIHsKICAgICAgICAgICAgcmV0dXJuICgoeCAmIDB4N0ZGRkZGRkYpICsgKHkgJiAweDdGRkZGRkZGKSkgXiAoeCAmIDB4ODAwMDAwMDApIF4gKHkgJiAweDgwMDAwMDAwKTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHdvcmRUb0hleCh3b3JkKSB7CiAgICAgICAgICAgIGxldCByZXN1bHQgPSAiIjsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gMzsgaSsrKSB7CiAgICAgICAgICAgICAgICBjb25zdCBieXRlID0gKHdvcmQgPj4+IChpICogOCkpICYgMjU1OwogICAgICAgICAgICAgICAgcmVzdWx0ICs9ICgiMCIgKyBieXRlLnRvU3RyaW5nKDE2KSkuc2xpY2UoLTIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiB1dGY4RW5jb2RlKHN0cikgewogICAgICAgICAgICBjb25zdCBieXRlcyA9IFtdOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgY29uc3QgY29kZSA9IHN0ci5jaGFyQ29kZUF0KGkpOwogICAgICAgICAgICAgICAgaWYgKGNvZGUgPCAweDgwKSB7CiAgICAgICAgICAgICAgICAgICAgYnl0ZXMucHVzaChjb2RlKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29kZSA8IDB4ODAwKSB7CiAgICAgICAgICAgICAgICAgICAgYnl0ZXMucHVzaCgweGMwIHwgKGNvZGUgPj4gNiksIDB4ODAgfCAoY29kZSAmIDB4M2YpKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29kZSA8IDB4ZDgwMCB8fCBjb2RlID49IDB4ZTAwMCkgewogICAgICAgICAgICAgICAgICAgIGJ5dGVzLnB1c2goMHhlMCB8IChjb2RlID4+IDEyKSwgMHg4MCB8ICgoY29kZSA+PiA2KSAmIDB4M2YpLCAweDgwIHwgKGNvZGUgJiAweDNmKSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGkrKzsKICAgICAgICAgICAgICAgICAgICBjb25zdCBzdXJyb2dhdGUgPSBzdHIuY2hhckNvZGVBdChpKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB1dGYzMiA9IDB4MTAwMDAgKyAoKChjb2RlICYgMHgzZmYpIDw8IDEwKSB8IChzdXJyb2dhdGUgJiAweDNmZikpOwogICAgICAgICAgICAgICAgICAgIGJ5dGVzLnB1c2goCiAgICAgICAgICAgICAgICAgICAgICAgIDB4ZjAgfCAodXRmMzIgPj4gMTgpLAogICAgICAgICAgICAgICAgICAgICAgICAweDgwIHwgKCh1dGYzMiA+PiAxMikgJiAweDNmKSwKICAgICAgICAgICAgICAgICAgICAgICAgMHg4MCB8ICgodXRmMzIgPj4gNikgJiAweDNmKSwKICAgICAgICAgICAgICAgICAgICAgICAgMHg4MCB8ICh1dGYzMiAmIDB4M2YpCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoYnl0ZXMpOwogICAgICAgIH0KCiAgICAgICAgbGV0IG1lc3NhZ2U7CiAgICAgICAgaWYgKHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJykgewogICAgICAgICAgICBtZXNzYWdlID0gdXRmOEVuY29kZShkYXRhKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBtZXNzYWdlID0gbmV3IFVpbnQ4QXJyYXkoZGF0YSk7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBtc2dMZW5ndGggPSBtZXNzYWdlLmxlbmd0aDsKICAgICAgICBjb25zdCB3b3JkQXJyYXkgPSBbXTsKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtc2dMZW5ndGggLSAzOyBpICs9IDQpIHsKICAgICAgICAgICAgd29yZEFycmF5LnB1c2goKG1lc3NhZ2VbaV0gPDwgMjQpIHwgKG1lc3NhZ2VbaSArIDFdIDw8IDE2KSB8IChtZXNzYWdlW2kgKyAyXSA8PCA4KSB8IG1lc3NhZ2VbaSArIDNdKTsKICAgICAgICB9CgogICAgICAgIGxldCByZW1haW5pbmdCeXRlcyA9IG1zZ0xlbmd0aCAlIDQ7CiAgICAgICAgaWYgKHJlbWFpbmluZ0J5dGVzID09PSAwKSB7CiAgICAgICAgICAgIHdvcmRBcnJheS5wdXNoKDB4ODAwMDAwMDApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGxldCBsYXN0V29yZCA9IDA7CiAgICAgICAgICAgIGZvciAobGV0IGkgPSBtc2dMZW5ndGggLSByZW1haW5pbmdCeXRlczsgaSA8IG1zZ0xlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBsYXN0V29yZCB8PSBtZXNzYWdlW2ldIDw8ICg4ICogKDMgLSAoaSAlIDQpKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGFzdFdvcmQgfD0gMHg4MCA8PCAoOCAqICgzIC0gcmVtYWluaW5nQnl0ZXMpKTsKICAgICAgICAgICAgd29yZEFycmF5LnB1c2gobGFzdFdvcmQpOwogICAgICAgIH0KCiAgICAgICAgd2hpbGUgKCh3b3JkQXJyYXkubGVuZ3RoICUgMTYpICE9PSAxNCkgewogICAgICAgICAgICB3b3JkQXJyYXkucHVzaCgwKTsKICAgICAgICB9CgogICAgICAgIHdvcmRBcnJheS5wdXNoKG1zZ0xlbmd0aCA+Pj4gMjkpOwogICAgICAgIHdvcmRBcnJheS5wdXNoKChtc2dMZW5ndGggPDwgMykgJiAweDBmZmZmZmZmZik7CgogICAgICAgIGNvbnN0IHcgPSBuZXcgQXJyYXkoODApOwogICAgICAgIGxldCBoMCA9IDB4Njc0NTIzMDE7CiAgICAgICAgbGV0IGgxID0gMHhFRkNEQUI4OTsKICAgICAgICBsZXQgaDIgPSAweDk4QkFEQ0ZFOwogICAgICAgIGxldCBoMyA9IDB4MTAzMjU0NzY7CiAgICAgICAgbGV0IGg0ID0gMHhDM0QyRTFGMDsKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB3b3JkQXJyYXkubGVuZ3RoOyBpICs9IDE2KSB7CiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTY7IGorKykgewogICAgICAgICAgICAgICAgd1tqXSA9IHdvcmRBcnJheVtpICsgal07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZm9yIChsZXQgaiA9IDE2OyBqIDwgODA7IGorKykgewogICAgICAgICAgICAgICAgd1tqXSA9IHJvdGF0ZUxlZnQod1tqIC0gM10gXiB3W2ogLSA4XSBeIHdbaiAtIDE0XSBeIHdbaiAtIDE2XSwgMSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxldCBhID0gaDAsIGIgPSBoMSwgYyA9IGgyLCBkID0gaDMsIGUgPSBoNDsKCiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgODA7IGorKykgewogICAgICAgICAgICAgICAgbGV0IGYsIGs7CiAgICAgICAgICAgICAgICBpZiAoaiA8IDIwKSB7CiAgICAgICAgICAgICAgICAgICAgZiA9IChiICYgYykgfCAoKH5iKSAmIGQpOwogICAgICAgICAgICAgICAgICAgIGsgPSAweDVBODI3OTk5OwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChqIDwgNDApIHsKICAgICAgICAgICAgICAgICAgICBmID0gYiBeIGMgXiBkOwogICAgICAgICAgICAgICAgICAgIGsgPSAweDZFRDlFQkExOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChqIDwgNjApIHsKICAgICAgICAgICAgICAgICAgICBmID0gKGIgJiBjKSB8IChiICYgZCkgfCAoYyAmIGQpOwogICAgICAgICAgICAgICAgICAgIGsgPSAweDhGMUJCQ0RDOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBmID0gYiBeIGMgXiBkOwogICAgICAgICAgICAgICAgICAgIGsgPSAweENBNjJDMUQ2OwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNvbnN0IHRlbXAgPSBhZGRVbnNpZ25lZChhZGRVbnNpZ25lZChyb3RhdGVMZWZ0KGEsIDUpLCBmKSwgYWRkVW5zaWduZWQoYWRkVW5zaWduZWQoZSwgd1tqXSksIGspKTsKICAgICAgICAgICAgICAgIGUgPSBkOwogICAgICAgICAgICAgICAgZCA9IGM7CiAgICAgICAgICAgICAgICBjID0gcm90YXRlTGVmdChiLCAzMCk7CiAgICAgICAgICAgICAgICBiID0gYTsKICAgICAgICAgICAgICAgIGEgPSB0ZW1wOwogICAgICAgICAgICB9CgogICAgICAgICAgICBoMCA9IGFkZFVuc2lnbmVkKGEsIGgwKTsKICAgICAgICAgICAgaDEgPSBhZGRVbnNpZ25lZChiLCBoMSk7CiAgICAgICAgICAgIGgyID0gYWRkVW5zaWduZWQoYywgaDIpOwogICAgICAgICAgICBoMyA9IGFkZFVuc2lnbmVkKGQsIGgzKTsKICAgICAgICAgICAgaDQgPSBhZGRVbnNpZ25lZChlLCBoNCk7CiAgICAgICAgfQoKICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgVWludDhBcnJheSgyMCk7CiAgICAgICAgW2gwLCBoMSwgaDIsIGgzLCBoNF0uZm9yRWFjaCgoaCwgaSkgPT4gewogICAgICAgICAgICByZXN1bHRbaSAqIDRdID0gKGggPj4+IDI0KSAmIDB4ZmY7CiAgICAgICAgICAgIHJlc3VsdFtpICogNCArIDFdID0gKGggPj4+IDE2KSAmIDB4ZmY7CiAgICAgICAgICAgIHJlc3VsdFtpICogNCArIDJdID0gKGggPj4+IDgpICYgMHhmZjsKICAgICAgICAgICAgcmVzdWx0W2kgKiA0ICsgM10gPSBoICYgMHhmZjsKICAgICAgICB9KTsKCiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgICAvLyDnuq8gSmF2YVNjcmlwdCDlrp7njrDnmoQgSE1BQy1TSEExCiAgICBmdW5jdGlvbiBobWFjU2hhMVN5bmMoa2V5Qnl0ZXMsIG1zZ0J5dGVzKSB7CiAgICAgICAgY29uc3Qga2V5ID0gbmV3IFVpbnQ4QXJyYXkoa2V5Qnl0ZXMpOwogICAgICAgIGNvbnN0IG1zZyA9IG5ldyBVaW50OEFycmF5KG1zZ0J5dGVzKTsKCiAgICAgICAgbGV0IGtleVBhZGRlZCA9IG5ldyBVaW50OEFycmF5KDY0KTsKICAgICAgICBpZiAoa2V5Lmxlbmd0aCA+IDY0KSB7CiAgICAgICAgICAgIGNvbnN0IGhhc2hlZEtleSA9IHNoYTEoa2V5KTsKICAgICAgICAgICAga2V5UGFkZGVkLnNldChoYXNoZWRLZXkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGtleVBhZGRlZC5zZXQoa2V5KTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IG9LZXlQYWQgPSBuZXcgVWludDhBcnJheSg2NCk7CiAgICAgICAgY29uc3QgaUtleVBhZCA9IG5ldyBVaW50OEFycmF5KDY0KTsKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA2NDsgaSsrKSB7CiAgICAgICAgICAgIG9LZXlQYWRbaV0gPSBrZXlQYWRkZWRbaV0gXiAweDVjOwogICAgICAgICAgICBpS2V5UGFkW2ldID0ga2V5UGFkZGVkW2ldIF4gMHgzNjsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGlubmVySW5wdXQgPSBuZXcgVWludDhBcnJheSg2NCArIG1zZy5sZW5ndGgpOwogICAgICAgIGlubmVySW5wdXQuc2V0KGlLZXlQYWQpOwogICAgICAgIGlubmVySW5wdXQuc2V0KG1zZywgNjQpOwogICAgICAgIGNvbnN0IGlubmVySGFzaCA9IHNoYTEoaW5uZXJJbnB1dCk7CgogICAgICAgIGNvbnN0IG91dGVySW5wdXQgPSBuZXcgVWludDhBcnJheSg2NCArIDIwKTsKICAgICAgICBvdXRlcklucHV0LnNldChvS2V5UGFkKTsKICAgICAgICBvdXRlcklucHV0LnNldChpbm5lckhhc2gsIDY0KTsKCiAgICAgICAgcmV0dXJuIHNoYTEob3V0ZXJJbnB1dCk7CiAgICB9CgogICAgLy8g5L+u5pS5IHN0ZWFtQ29kZSDlh73mlbDkvb/nlKjlkIzmraXniYjmnKwKICAgIGZ1bmN0aW9uIHN0ZWFtQ29kZVN5bmMoc2hhcmVkU2VjcmV0LCB1bml4Tm93KSB7CiAgICAgICAgY29uc3Qga2V5QjY0ID0gZGV0ZWN0QW5kQ29udmVydChzaGFyZWRTZWNyZXQpOwogICAgICAgIGNvbnN0IGtleSA9IHRvQnl0ZXMoa2V5QjY0KTsKICAgICAgICBjb25zdCB0cyA9IE1hdGguZmxvb3IodW5peE5vdyAvIDMwKTsKICAgICAgICBjb25zdCBoID0gaG1hY1NoYTFTeW5jKGtleSwgaTJieXRlczgodHMpKTsKICAgICAgICBjb25zdCBzdGFydCA9IGhbaC5sZW5ndGggLSAxXSAmIDB4MGY7CiAgICAgICAgbGV0IGZ1bGwgPSAoKGhbc3RhcnRdICYgMHg3ZikgPDwgMjQpIHwgKGhbc3RhcnQgKyAxXSA8PCAxNikgfCAoaFtzdGFydCArIDJdIDw8IDgpIHwgKGhbc3RhcnQgKyAzXSk7CiAgICAgICAgbGV0IG91dCA9ICIiOwogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNTsgaSsrKSB7IG91dCArPSBDSEFSU1tmdWxsICUgQ0hBUlMubGVuZ3RoXTsgZnVsbCA9IE1hdGguZmxvb3IoZnVsbCAvIENIQVJTLmxlbmd0aCk7IH0KICAgICAgICByZXR1cm4gb3V0OwogICAgfQoKICAgIC8vIOS/ruaUuSB0aWNrIOWHveaVsAogICAgZnVuY3Rpb24gdGljaygpIHsKICAgICAgICBjb25zdCBzZWMgPSBlbHMuc2VjcmV0LnZhbHVlLnRyaW0oKTsKICAgICAgICBpZiAoIXNlYykgewogICAgICAgICAgICBlbHMuY29kZS50ZXh0Q29udGVudCA9ICLor7fovpPlhaUgU2VjcmV0IjsKICAgICAgICAgICAgZWxzLmNvcHkuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBjb25zdCBub3cgPSBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKTsKICAgICAgICBjb25zdCBsZWZ0ID0gMzAgLSAobm93ICUgMzApOwoKICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCBjb2RlID0gc3RlYW1Db2RlU3luYyhzZWMsIG5vdyk7CiAgICAgICAgICAgIGVscy5jb2RlLnRleHRDb250ZW50ID0gY29kZTsKICAgICAgICAgICAgZWxzLmJhci5zdHlsZS53aWR0aCA9IChsZWZ0IC8gMzAgKiAxMDApLnRvRml4ZWQoMSkgKyAiJSI7CiAgICAgICAgICAgIGVscy5sZWZ0LnRleHRDb250ZW50ID0gIuWJqeS9mSAiICsgbGVmdCArICIgcyI7CiAgICAgICAgICAgIGVscy5jb3B5LmRpc2FibGVkID0gZmFsc2U7CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdUT1RQIGdlbmVyYXRpb24gZXJyb3I6JywgZSk7CiAgICAgICAgICAgIGVscy5jb2RlLnRleHRDb250ZW50ID0gIumUmeivrzogIiArIGUubWVzc2FnZTsKICAgICAgICAgICAgZWxzLmNvcHkuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgIH0KICAgIH0KCiAgICBjb25zdCBlbHMgPSB7CiAgICAgICAgc2VjcmV0OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VjcmV0JyksCiAgICAgICAgY29kZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvZGUnKSwKICAgICAgICBiYXI6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiYXInKSwKICAgICAgICBsZWZ0OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGVmdCcpLAogICAgICAgIGNvcHk6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb3B5JykKICAgIH07CiAgICBsZXQgdGltZXIgPSBudWxsOwoKICAgIGZ1bmN0aW9uIGdldFNlY3JldEZyb21VUkkoKSB7CiAgICAgICAgY29uc3QgaGFzaCA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoOwogICAgICAgIGlmIChoYXNoLnN0YXJ0c1dpdGgoIiNzZWNyZXQ9IikpIHsKICAgICAgICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChoYXNoLnN1YnN0cmluZyg4KSkucmVwbGFjZSgvXHMvZywgJysnKTsKICAgICAgICB9CiAgICAgICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKTsKICAgICAgICByZXR1cm4gcGFyYW1zLmdldCgic2VjcmV0Iik/LnJlcGxhY2UoL1xzL2csICcrJykgfHwgIiI7CiAgICB9CgogICAgYXN5bmMgZnVuY3Rpb24gY29weUNvZGUoKSB7CiAgICAgICAgY29uc3QgY29kZSA9IGVscy5jb2RlLnRleHRDb250ZW50OwogICAgICAgIGlmIChjb2RlID09PSAi4oCU4oCU4oCUIiB8fCBjb2RlLmluY2x1ZGVzKCLor7fovpPlhaUiKSB8fCBjb2RlLmluY2x1ZGVzKCLml6DmlYgiKSkgcmV0dXJuOwoKICAgICAgICB0cnkgewogICAgICAgICAgICBhd2FpdCBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChjb2RlKTsKICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgY29uc3QgdGV4dEFyZWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpOwogICAgICAgICAgICB0ZXh0QXJlYS52YWx1ZSA9IGNvZGU7CiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGV4dEFyZWEpOwogICAgICAgICAgICB0ZXh0QXJlYS5zZWxlY3QoKTsKICAgICAgICAgICAgZG9jdW1lbnQuZXhlY0NvbW1hbmQoJ2NvcHknKTsKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0ZXh0QXJlYSk7CiAgICAgICAgfQoKICAgICAgICBlbHMuY29weS50ZXh0Q29udGVudCA9ICLlt7LlpI3liLYiOwogICAgICAgIGVscy5jb3B5LmNsYXNzTGlzdC5hZGQoJ2NvcHktc3VjY2VzcycpOwogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICBlbHMuY29weS50ZXh0Q29udGVudCA9ICLlpI3liLYiOwogICAgICAgICAgICBlbHMuY29weS5jbGFzc0xpc3QucmVtb3ZlKCdjb3B5LXN1Y2Nlc3MnKTsKICAgICAgICB9LCAxMDAwKTsKICAgIH0KCiAgICB3aW5kb3cub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgIGNvbnN0IHNlY3JldEZyb21VUkkgPSBnZXRTZWNyZXRGcm9tVVJJKCk7CiAgICAgICAgaWYgKHNlY3JldEZyb21VUkkpIHsKICAgICAgICAgICAgZWxzLnNlY3JldC52YWx1ZSA9IHNlY3JldEZyb21VUkk7CiAgICAgICAgfQogICAgICAgIHRpY2soKTsKICAgICAgICB0aW1lciA9IHNldEludGVydmFsKHRpY2ssIDEwMDApOwogICAgfTsKCiAgICBlbHMuc2VjcmV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4gewogICAgICAgIGlmICh0aW1lcikgeyBjbGVhckludGVydmFsKHRpbWVyKTsgdGltZXIgPSBudWxsOyB9CiAgICAgICAgdGljaygpOwogICAgICAgIHRpbWVyID0gc2V0SW50ZXJ2YWwodGljaywgMTAwMCk7CiAgICB9KTsKCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29weScpLm9uY2xpY2sgPSBjb3B5Q29kZTsKPC9zY3JpcHQ+Cgo8L2h0bWw+#secret=